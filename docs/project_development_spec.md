# 项目开发规范（Project Development Spec）

## 文档摘要

前后端开发会相互制约并拖慢整体进度，因此需要**将前后端开发解耦、尽量独立推进**。解耦的关键是以 **API 接口文档为契约**，采用 API 优先（API-First）开发，使前端与后端（及多 Agent）可并行工作、减少互相阻塞。

本规范约定：**文档存放位置**、**三类核心文档的职责与结构**、**待办与依赖的写法**、以及 **AI 使用与维护这些文档的约定**，便于人类与 AI 快速理解与索引。更细的 API 设计、错误格式、Mock 与联调策略见项目内《前后端联调 Skills》文档。

---

## 目录索引

1. [核心原则：为何要解耦与 API 为契约](#1-核心原则为何要解耦与-api-为契约)
2. [文档存放与维护责任](#2-文档存放与维护责任)
3. [三类核心文档](#3-三类核心文档)
4. [项目进展文档（project_process.md）详解](#4-项目进展文档project_processmd详解)
5. [API 开发文档（api_development.md）要点](#5-api-开发文档api_developmentmd要点)
6. [开发日志（changelog.md）要点](#6-开发日志changelogmd要点)
7. [AI 使用与更新文档的约定](#7-ai-使用与更新文档的约定)
8. [参考与延伸](#8-参考与延伸)

---

## 1. 核心原则：为何要解耦与 API 为契约

- **问题**：前后端强耦合会导致一方等另一方、联调冲突多、返工频繁，整体开发速度下降。
- **思路**：把「接口长什么样」提前定下来，作为**唯一事实来源（Single Source of Truth）**，前后端都围绕这份契约开发与联调。
- **做法**：
  - **API-First / Contract-First**：在写具体实现前，先确定并维护 API 契约（推荐 OpenAPI/Swagger）；契约即文档，文档即契约。
  - **并行开发**：后端可先提供 Mock 或占位实现，前端可基于契约生成类型与请求客户端、或使用 Mock 服务独立开发与自测。
- **效果**：前后端可独立迭代、独立部署与扩展，减少互相等待；契约统一后联调阶段只需对契约校验，而非临时对齐口述约定。

---

## 2. 文档存放与维护责任

- **统一目录**：以下三类文档均放在 **`project_process_for_ai`** 目录中（若不存在则创建）。
- **维护者**：前端开发 Agent、后端开发 Agent（以及参与该项目的其他 AI/人类）**共同维护**，任何一方修改接口、进度或变更时，都需同步更新相应文档。
- **通用格式约定**：
  - 每份文档**前两部分**固定为：**① 文档摘要**、**② 目录索引**，便于 AI 快速理解主旨并跳转到章节。
  - 文档更新若影响其他模块或联调，需在 `project_process.md` 的对应模块待办中**写明依赖与触发条件**，便于完成当前或相关开发后触发联调或下游任务。

---

## 3. 三类核心文档

| 文档 | 用途 | 灵魂程度 |
|------|------|----------|
| **api_development.md** | API 接口契约与开发说明（路径、参数、响应、错误、鉴权等） | 联调与实现的依据 |
| **project_process.md** | 项目进展与灵魂文档：待办、功能模块、依赖关系、联调触发 | **主入口，AI 开发的首要参考** |
| **changelog.md** | 开发日志与 API/功能变更记录（时间倒序、版本与兼容说明） | 回溯与兼容性判断 |

---

## 4. 项目进展文档（project_process.md）详解

项目进展文档是 **AI 进行开发的主入口与项目灵魂文档**，应涵盖待办事项与功能模块，并**显式写出依赖与联调关系**。

### 4.1 待办事项

- **不仅是任务列表**：还需包含 **依赖关系**，标明「谁依赖谁」「完成后触发谁」。
- **依赖类型**（可选用以下表述，便于 AI 与人类理解）：
  - **Finish-to-Start**：任务 B 须在任务 A **完成后**才能开始（如：前端调用须在接口定稿后）。
  - **Start-to-Start**：任务 B 须在任务 A **开始后**才能开始（如：文档与实现同步推进）。
  - **Finish-to-Finish**：任务 B 须在任务 A **完成后**才能完成（如：联调验收依赖两端都完成）。
- **触发与提醒**：若某任务完成后需要触发其他模块开发或联调，应在该任务或依赖方任务中**明确写出**，例如：「接口 xxx 已就绪，可触发前端联调」「数据库迁移完成后，可进行后端校验模块开发」。

### 4.2 功能模块

- **建议包含的模块**（按需增删）：**前端**、**交互/UI**、**后端接口**、**后端数据库**、**算法**、**后端校验**、**运维/部署** 等。
- **每个模块建议包含**：
  - **模块定位**：一句话说明该模块的职责与边界。
  - **当前开发状况**：进行中 / 已完成 / 阻塞（并简述原因）。
  - **待办开发事项**：具体任务列表；若涉及**与其他模块的联调或依赖**，需写清依赖方、接口或数据约定，以便 AI 完成本模块或相关模块后能触发联调或下游任务。
- **与 API 文档联动**：当 API 契约在 `api_development.md` 或 OpenAPI 中更新且影响前端/后端任务时，应在 `project_process.md` 对应模块的待办中体现（例如：「按 api_development.md 中 xxx 接口实现前端调用」）。

### 4.3 推荐结构示例（可复制为模板）

```markdown
## 待办事项
- [ ] 任务 A（后端）：定义 /users 接口并在 api_development.md 定稿  
  - 完成后触发：前端「用户列表」页开发与联调
- [ ] 任务 B（前端）：依赖任务 A；按 api_development.md 实现 /users 调用与展示

## 功能模块

### 前端
- **定位**：用户界面与交互，通过 API 与后端通信。
- **状况**：进行中。
- **待办**：见上方待办事项中任务 B；联调时以 api_development.md 为准。

### 后端接口
- **定位**：提供 REST API，实现 api_development.md 中的契约。
- **状况**：进行中。
- **待办**：见任务 A；定稿后更新 changelog 并标注「可联调 /users」。
```

---

## 5. API 开发文档（api_development.md）要点

- 该文档是前后端联调的**核心契约**，应与实现（或 OpenAPI 描述）保持一致。
- **必备内容**：接口列表（方法、路径、说明）、请求参数（名、类型、必填/可选、说明）、响应格式（含分页约定）、错误与状态码（HTTP + 业务错误码）、认证与安全（若需要）。
- **建议**：使用 OpenAPI/Swagger 时，与 `api_development.md` 文字描述保持一致，并用同一份 OpenAPI 生成 Mock、类型或客户端代码，避免文档与实现漂移。
- 更细的**错误体格式、版本策略、命名约定**见《前后端联调 Skills》。

---

## 6. 开发日志（changelog.md）要点

- **顺序**：以**时间倒序**记录（最新在上），便于回溯与兼容性判断。
- **版本**：建议与**语义化版本**结合——主版本表 Breaking Change，次版本表新功能，修订号表 Bug 修复。
- **API 变更**：写清影响的路径/参数/响应、是否向后兼容、迁移或注意事项；可与 `api_development.md` 的「变更记录」互引。
- **分类建议**（可选用）：Added（新增）、Changed（变更）、Fixed（修复）、Removed（移除）、Deprecated（弃用）；顶部可设 [Unreleased] 收纳未发布变更。
- 规范可参考 [Keep a Changelog](https://keepachangelog.com/)。

---

## 7. AI 使用与更新文档的约定

- **优先阅读**：接到开发任务时，AI 应优先阅读 `project_process_for_ai/project_process.md`，再按需查看 `api_development.md` 与 `changelog.md`。
- **更新时机**：
  - 完成或推进某任务后，更新 `project_process.md` 中对应模块的「当前开发状况」与待办勾选。
  - 若本次修改涉及 API 契约或对外行为，同步更新 `api_development.md` 与 `changelog.md`，并在 `project_process.md` 中注明可触发的联调或下游任务。
- **依赖与触发**：在待办或模块描述中写清「依赖谁」「完成后触发谁」，避免遗漏联调或下游步骤。

---

## 8. 参考与延伸

- **API-First 与 OpenAPI**：  
  [OpenAPI 规范与最佳实践](https://spec.openapis.org/oas/latest.html)、  
  [API-First 开发中 OpenAPI 的作用](https://openapispec.com/docs/how/how-can-openapi-support-api-first-development/)
- **前后端解耦与契约**：  
  项目内《前后端联调 Skills》（`前后端联调skills.md`）——含 API 设计补充、错误格式、Mock 与联调策略。
- **依赖管理**：  
  [Project dependencies: Types & ways to manage them](https://www.atlassian.com/agile/project-management/project-management-dependencies)
- **Changelog 规范**：  
  [Keep a Changelog](https://keepachangelog.com/)

---*本规范旨在将前后端与多 Agent 协作统一到「契约 + 进度 + 变更」三份文档上，减少联调摩擦并提高整体开发效率。可根据项目规模增删模块或链接到更细的规范文档。*